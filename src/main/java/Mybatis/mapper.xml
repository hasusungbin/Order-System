<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="insertOrder.OrderDAO">
  <select id="getSearchList" resultType="insertOrder.Order">
        SELECT * FROM cargoorder
        <where>
            <if test="startDate != null and endDate != null">
                AND orderDate BETWEEN #{startDate} AND #{endDate}
            </if>
            <if test="refNumber != 0">
                AND refNumber = #{refNumber}
            </if>
            <if test="userName != null and userName != ''">
                AND userName = #{userName}
            </if>
            <if test="departureName != null and departureName != ''">
                AND departureName = #{departureName}
            </if>
            <if test="arrivalName != null and arrivalName != ''">
                AND arrivalName = #{arrivalName}
            </if>
            <if test="arrivalCities != null and arrivalCities != ''">
                AND arrivalCities = #{arrivalCities}
            </if>
            <if test="orderNumber != null and orderNumber != ''">
                AND orderNumber LIKE CONCAT('%', #{orderNumber}, '%')
            </if>
        </where>
		ORDER BY orderID DESC LIMIT #{pageSize} OFFSET #{pageNumber}
    </select>
	<select id="getAllList" resultType="insertOrder.Order">
		SELECT * FROM cargoorder
		ORDER BY orderID DESC
	</select>
	
	
	<!-- 검색 + 페이징 리스트 조회 -->
    <select id="getPagedList" resultType="insertOrder.Order">
        SELECT * FROM cargoorder
        WHERE 1=1
		<if test="startDate != null and endDate != null">
			AND orderDate BETWEEN #{startDate} AND #{endDate}
        </if>
        <if test="refNumber != null">
            AND refNumber = #{refNumber}
        </if>
        <if test="userName != null and userName != ''">
            AND userName LIKE CONCAT('%', #{userName}, '%')
        </if>
        <if test="departureName != null and departureName != ''">
            AND departureName LIKE CONCAT('%', #{departureName}, '%')
        </if>
        <if test="arrivalName != null and arrivalName != ''">
            AND arrivalName LIKE CONCAT('%', #{arrivalName}, '%')
        </if>
        <if test="arrivalCities != null and arrivalCities != ''">
            AND arrivalCities LIKE CONCAT('%', #{arrivalCities}, '%')
        </if>
        <if test="orderNumber != null and orderNumber != ''">
            AND orderNumber LIKE CONCAT('%', #{orderNumber}, '%')
        </if>
        ORDER BY orderID DESC
        LIMIT #{pageSize} OFFSET #{offset}
    </select>

    <!-- 검색 결과 개수 조회 -->
    <select id="getTotalCount" resultType="int">
        SELECT COUNT(*) FROM cargoorder
        WHERE 1=1
		<if test="startDate != null and endDate != null">
			AND orderDate BETWEEN #{startDate} AND #{endDate}
		</if>
        <if test="refNumber != null">
            AND refNumber = #{refNumber}
        </if>
        <if test="userName != null and userName != ''">
            AND userName LIKE CONCAT('%', #{userName}, '%')
        </if>
        <if test="departureName != null and departureName != ''">
            AND departureName LIKE CONCAT('%', #{departureName}, '%')
        </if>
        <if test="arrivalName != null and arrivalName != ''">
            AND arrivalName LIKE CONCAT('%', #{arrivalName}, '%')
        </if>
        <if test="arrivalCities != null and arrivalCities != ''">
            AND arrivalCities LIKE CONCAT('%', #{arrivalCities}, '%')
        </if>
        <if test="orderNumber != null and orderNumber != ''">
            AND orderNumber LIKE CONCAT('%', #{orderNumber}, '%')
        </if>
    </select>
	
	<select id="getAllOrders" resultType="inserOrder.Order">
    SELECT * FROM cargoorder
    WHERE 1=1
    <if test="refNumber != null">
        AND refNumber = #{refNumber}
    </if>
    <if test="userName != null and userName != ''">
        AND userName LIKE CONCAT('%', #{userName}, '%')
    </if>
    <if test="departureName != null and departureName != ''">
        AND departureName LIKE CONCAT('%', #{departureName}, '%')
    </if>
    <if test="arrivalName != null and arrivalName != ''">
        AND arrivalName LIKE CONCAT('%', #{arrivalName}, '%')
    </if>
    <if test="arrivalCities != null and arrivalCities != ''">
        AND arrivalCities LIKE CONCAT('%', #{arrivalCities}, '%')
    </if>
    <if test="orderNumber != null and orderNumber != ''">
        AND orderNumber = #{orderNumber}
    </if>
    ORDER BY orderID DESC
    LIMIT #{pageSize} OFFSET #{offset}
</select>
	
</mapper>